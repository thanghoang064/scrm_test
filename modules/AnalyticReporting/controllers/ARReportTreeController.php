<?php

/*** DOMAIN_CHECK ***/
 include_once "modules/AnalyticReporting/controllers/ARController.php";class ARReportTreeController extends ARController{function listReports(){global $mod_strings;$ZZZZZZZR1717 = new ZZZZZZZS1818();$ZZZZZZZZZZZZZZZZZZZZZB11 = PlatformConnector::ZZZZZZZZZZZZZV2121();$ZZZZZZS1818 = new ZZZZZy24();$ZZZZZZZa0 = false;if($ZZZZZZZZZZZZZZZZZZZZZB11->ZZZZZZZV2121() && isset($_REQUEST["showHidden"]) && !empty($_REQUEST["showHidden"])) {$ZZZZZZZa0 = true;} $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZo14 = ($ZZZZZZS1818->getValue("reportTreeAdminAccess"))?1:0;$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22 = new ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZl11($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZo14, $mod_strings);if(isset($_REQUEST["search"]) && $_REQUEST["search"] && isset($_REQUEST["searchCriteria"]) && $_REQUEST["searchCriteria"]!=""){$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZg6 = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZB11($ZZZZZZZR1717,$ZZZZZZZZZZZZZZZZZZZZZB11, $ZZZZZZZa0, explode(" ",trim($_REQUEST["searchCriteria"])), isset($_REQUEST["matchAll"]));$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["SEARCHCRITERIA"] = $_REQUEST["searchCriteria"];if(isset($_REQUEST["matchAll"])){$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["matchAll"] = "checked";}} else {$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZg6 = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZB11($ZZZZZZZR1717,$ZZZZZZZZZZZZZZZZZZZZZB11, $ZZZZZZZa0);} $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZm12 = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZp15();$ZZZZZZZZV2121 = new ZZZZZZZZW2222($ZZZZZZZR1717);$ZZZZZZZZZZZz25 = new ZZZZZZW2222();$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZH77 = ZZZZZZZZZZZZZz25::load('common', 'common');$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["TOGGLEHIDDEN"] = ($ZZZZZZZa0) ? 'false' : 'true';$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["REPORTTREE"] = json_encode($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZg6);$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["DELETABLE_REPORTS"] = json_encode($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZm12);$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["REPORTSCHEDULEUSERS"] = json_encode($ZZZZZZZZV2121->ZZZZZZZZZZZZZZZZZJ99());$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["REPORTACCESSUSERS"] = json_encode($ZZZZZZZZV2121->ZZZZZZZZZZZZZZZZZI88()) ;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["REPORTUSERS"] = json_encode($ZZZZZZZZV2121->ZZZZZZZZZZZZh7());$ZZZZZZZw22 = $ZZZZZZZZZZZz25->ZZZZZZZs18('id, title', 'visible=1', 'title ASC');$ZZZZZZZw22 = ZZZZZZZZZZZZZZZZZR1717::ZZZZZZZZZZZZZZZZZZq16($ZZZZZZZw22);$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22['CATEGORIES'] = json_encode($ZZZZZZZw22);$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["ISADMIN"] = ($ZZZZZZZZZZZZZZZZZZZZZB11->ZZZZZZZV2121())?1:0;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["CANEDIT"] = ($ZZZZZZZZZZZZZZZZZZZZZB11->ZZZZZZZV2121())?1:0;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["CANDELETE"] = ($ZZZZZZZZZZZZZZZZZZZZZB11->ZZZZZZZV2121())?1:0;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["reportBuilderPublic"] = (ZZZZZZZZZZZZZZZZZR1717::ZZZZZZZZZZZZZZZZZZt19($ZZZZZZS1818))?1:0;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22["reportTreeAdminAccess"] = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZo14;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22['MOD'] = $mod_strings;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22['DICTIONARY'] = json_encode($mod_strings);$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22['commonConfig'] = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZH77;$this->ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZC22['SERVERURL'] = PlatformConnector::getUrl();} function toggle(){$ZZZZZZZZZZZZZZZZZZZZZB11 = PlatformConnector::ZZZZZZZZZZZZZV2121();if($ZZZZZZZZZZZZZZZZZZZZZB11->ZZZZZZZV2121()){if(isset($_REQUEST["record"]) && isset($_REQUEST["key"]) && isset($_REQUEST["value"])) {$ZZZZZZZy24 = $_REQUEST["record"];$Zr17 = $_REQUEST["key"];$value = $_REQUEST["value"];$ZZZZZZZZZZZz25 = new ZZZZZZW2222();$ZZZZZZZZZZZz25->ZZZZZZZx23($ZZZZZZZy24, $Zr17, $value);}} PlatformConnector::ZZZZZZZZZZZZZZx23($_SERVER["HTTP_REFERER"]);exit;} function deleteReport(){$ZZZZZZZR1717 = new ZZZZZZZS1818();$ZZZZZZZZV2121 = new ZZZZZZZZW2222($ZZZZZZZR1717);$ZZZZZZZZZZZZZZZZZZZZZB11 = PlatformConnector::ZZZZZZZZZZZZZV2121();$ZZZZZZy24 = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZZZb1 = $ZZZZZZZZV2121->ZZZZZZZZZ2525($ZZZZZZZZZZZZZZZZZZZZZB11, $ZZZZZZy24);if($ZZZZZZZZZZZZZZZZZZZZb1>1){$ZZZZZZZZZZZA00 = new ZZZZZZZD33();$ZZZZZZZZZZZA00->deleteReport($ZZZZZZy24);$ZZZZZZZZZZX2323 = new ZZZZZZZZZZw22();$ZZZZZZZZZZX2323->ZZZZZZZZZZZs18($ZZZZZZy24);} $ZZZZZx23 = ZZZZZZZZZZZZZz25::load('common', 'common');PlatformConnector::ZZZZZZZZZZZZZZx23($ZZZZZx23['url']['list']);exit;} function massSchedule(){$db = PlatformConnector::ZZZZZZZZZZZZZZK1010();$ZZZZZZZR1717 = new ZZZZZZZS1818();$ZZZZZZZZV2121 = new ZZZZZZZZW2222($ZZZZZZZR1717);$p15 = $_POST;if(isset($p15['reportIds']) && ($p15['reportIds']) > 0) {foreach($p15['reportIds'] as $ZZZZZZy24) {$ZZZZZZZR1717->ZZZZZZZZZZZZZZZZZl11($ZZZZZZy24, $p15, $db, $ZZZZZZZZV2121);}} echo json_encode(array("status" => "ok"));exit;} function saveCategory(){$ZZZZZZZZZZZz25 = new ZZZZZZW2222();$ZZZZZZZZZZZZZZy24 = $_REQUEST["_action"];$id = $_REQUEST["id"];$ZZZZZZZd3 = isset($_REQUEST["parentId"])?$_REQUEST["parentId"]:0;$ZZZZZZZl11 = isset($_REQUEST["position"])?$_REQUEST["position"]:0;$title = isset($_REQUEST["title"])?$_REQUEST["title"]:"";$description = isset($_REQUEST["description"])?$_REQUEST["description"]:"";switch($ZZZZZZZZZZZZZZy24) {case "add": $ZZZZZZZZZZZz25->ZZZZZZZc2($id, $title, $description);break;case "edit": $ZZZZZZZZZZZz25->ZZZZZZZg6($id, $title, $description);break;case "delete": $ZZZZZZZZZZZz25->ZZZZZZZh7($id);break;case "moveCategory": $ZZZZZZZZZZZz25->ZZZZZZZk10($id, $ZZZZZZZd3, $ZZZZZZZl11, 'categories');break;case "moveItem": $ZZZZZZZZZZZz25->ZZZZZZZk10($id, $ZZZZZZZd3, $ZZZZZZZl11, 'reports');break;case "repairReports": $P1515 = $ZZZZZZZZZZZz25->ZZZZZZZo14($ZZZZZZZd3, 'reports');break;case "repairCategories": $P1515 = $ZZZZZZZZZZZz25->ZZZZZZZo14($ZZZZZZZd3, 'categories');break;} $ZZZZZZZZZZf5 = array("status" => "success");if(isset($P1515) && !$P1515) {$ZZZZZZZZZZf5['status'] = 'failure';} echo json_encode($ZZZZZZZZZZf5);die;} function exportReports(){$ZZZZZZZZZZZy24 = $_REQUEST['reportIds'];$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7 = new ZZZZZZZZZZZw22();$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7->exportReports($ZZZZZZZZZZZy24);} function importReports(){$ZZZZZx23 = ZZZZZZZZZZZZZz25::load('common', 'common');$ZZZZZZZZZZZZZZy24 = $_REQUEST["_action"];if($ZZZZZZZZZZZZZZy24 == "import"){$ZZZZZZZZZZZC22 = $_FILES['importFile']['tmp_name'];$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZi8 = $_REQUEST["importType"];$ZZZZZZZZZZZF55 = $_REQUEST["category"];if($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZi8 == "withCategories"){$ZZZZZZZZZZZF55 = null;} $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZj9 = FunctionWrapper::_file_get_contents($ZZZZZZZZZZZC22);$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7 = new ZZZZZZZZZZZw22();$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7->importReports($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZj9, $ZZZZZZZZZZZF55);if($ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7->ZZZZZZZZZZZx23()) {$_SESSION["analyticreporting_ImportErrors"] = $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZh7->ZZZZZZZZZf5();} PlatformConnector::ZZZZZZZZZZZZZZx23($ZZZZZx23['url']['list']);} elseif($ZZZZZZZZZZZZZZy24 == "errorCheck"){if(empty($_SESSION["analyticreporting_ImportErrors"])){echo json_encode(array("status" => "ok"));die;}else {$ZZZZZZZq16 = $_SESSION["analyticreporting_ImportErrors"];unset($_SESSION["analyticreporting_ImportErrors"]);$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZk10 ="";foreach ($ZZZZZZZq16 as $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZl11) {$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZk10.= $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZl11;} echo json_encode(array("status" => "fail", "errorMsg" => $ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZk10));die;}}}}